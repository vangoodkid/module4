<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Danh s√°ch Blog - T·∫£i th√™m</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>

<h2>Danh s√°ch b√†i vi·∫øt</h2>
<table border="1">
  <thead>
  <tr>
    <th>STT</th>
    <th>Ti√™u ƒë·ªÅ</th>
    <th>T√≥m t·∫Øt</th>
    <th>N·ªôi dung</th>
  </tr>
  </thead>
  <tbody id="blogTable"></tbody>
</table>

<button id="btnLoadMore">T·∫£i th√™m</button>

<script>
  $(function() {
    let page = 0; // trang hi·ªán t·∫°i
    const size = 5; // s·ªë b√†i m·ªói l·∫ßn t·∫£i

    function loadBlogs(reset = false) {
      $.ajax({
        url: `http://localhost:8080/v1/api/blogs?page=${page}&size=${size}`,
        type: 'GET',
        success: function(data) {
          let html = '';
          if (data.content.length === 0) {
            $('#btnLoadMore').prop('disabled', true).text('H·∫øt b√†i r·ªìi üòÑ');
            return;
          }

          for (let i = 0; i < data.content.length; i++) {
            const b = data.content[i];
            html += `<tr>
                        <td>${(page * size) + i + 1}</td>
                        <td>${b.title}</td>
                        <td>${b.summary}</td>
                        <td>${b.content}</td>
                    </tr>`;
          }

          if (reset) $('#blogTable').html(html);
          else $('#blogTable').append(html);
        },
        error: function() {
          alert("L·ªói khi t·∫£i b√†i vi·∫øt!");
        }
      });
    }

    // t·∫£i trang ƒë·∫ßu ti√™n khi m·ªü
    loadBlogs(true);

    // n√∫t t·∫£i th√™m
    $('#btnLoadMore').click(function() {
      page++;
      loadBlogs();
    });
  });
</script>

</body>
</html>
